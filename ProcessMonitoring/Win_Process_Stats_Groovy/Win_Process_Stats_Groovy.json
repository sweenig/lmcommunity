{
  "id" : 13504265,
  "description" : "Monitor the resource usage of a process.",
  "group" : "_WeenigWare Community",
  "appliesTo" : "isWindows()",
  "technology" : "https://docs.microsoft.com/en-us/previous-versions/aa394323(v%3Dvs.85)",
  "tags" : "",
  "checksum" : "2bc24e77cc602ef0b1652b6fda23903a",
  "lineageId" : "LbJuydTOSTK0vcttdXskrg",
  "name" : "Win_Process_Stats_Groovy",
  "displayName" : "Processes",
  "version" : 1587132701,
  "auditVersion" : 0,
  "hasMultiInstances" : true,
  "collectInterval" : 180,
  "collectMethod" : "batchscript",
  "collectorAttribute" : {
    "name" : "batchscript",
    "linuxCmdline" : "",
    "linuxScript" : "",
    "groovyScript" : "import com.santaba.agent.groovyapi.win32.WMI\n\ndef host = hostProps.get(\"system.hostname\")\n\ndef process_list = WMI.queryAll(host, \"select * from Win32_PerfRawData_PerfProc_Process\")\n\nprocess_list.each{\n  wildvalue=it[\"NAME\"].replaceAll(/\\=|\\:|\\\\|\\#|\\s/, '')\n  println wildvalue+\".HandleCount=\"+it[\"HANDLECOUNT\"]\n  println wildvalue+\".IODataBytesPerSec=\"+it[\"IODATABYTESPERSEC\"]\n  println wildvalue+\".PercentProcessorTime=\"+it[\"PERCENTPROCESSORTIME\"]\n  println wildvalue+\".ProcessID=\"+it[\"IDPROCESS\"]\n  println wildvalue+\".ThreadCount=\"+it[\"THREADCOUNT\"]\n  println wildvalue+\".WorkingSet=\"+it[\"WORKINGSET\"]\n}\nreturn(0)",
    "scriptType" : "embed",
    "windowsCmdline" : "",
    "windowsScript" : ""
  },
  "enableAutoDiscovery" : true,
  "autoDiscoveryConfig" : {
    "persistentInstance" : false,
    "disableInstance" : false,
    "deleteInactiveInstance" : true,
    "instanceAutoGroupMethod" : "none",
    "instanceAutoGroupMethodParams" : "",
    "scheduleInterval" : 0,
    "method" : {
      "name" : "ad_script",
      "type" : "embeded",
      "winScript" : null,
      "winCmdline" : null,
      "linuxCmdline" : null,
      "linuxScript" : null,
      "groovyScript" : "import com.santaba.agent.groovyapi.win32.WMI\n\ndef host = hostProps.get(\"system.hostname\")\n\ndef process_list = WMI.queryAll(host, \"select * from Win32_PerfRawData_PerfProc_Process\")\n\nprocess_list.each {\n  println(\"${it[\"NAME\"].replaceAll(/\\=|\\:|\\\\|\\#|\\s/, '')}##${it[\"NAME\"]}\")\n}\nreturn(0)\n"
    },
    "filters" : [ {
      "attribute" : "##WILDVALUE##",
      "operation" : "RegexNotMatch",
      "value" : "_Total|Idle",
      "comment" : "Excluding processes generally"
    } ]
  },
  "dataPoints" : [ {
    "id" : 17705,
    "dataSourceId" : 13504265,
    "name" : "HandleCount",
    "description" : "Total number of handles the process has open. This number is the sum of the handles currently open by each thread in the process.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.HandleCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17706,
    "dataSourceId" : 13504265,
    "name" : "IODataBytesPerSec",
    "description" : "Rate at which the process is reading and writing bytes in I/O operations. This property counts all I/O activity generated by the process to include file, network, and device I/Os.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.IODataBytesPerSec",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17707,
    "dataSourceId" : 13504265,
    "name" : "ProcessCPUPercent",
    "description" : "Percent of CPU cycles. Value exceeding 100% means the process consumes resources of more than one CPU or core.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "PercentProcessorTime/100000",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "The process ##INSTANCE## ##DSIDESCRIPTION## on Windows host ##HOST## is taking up ##VALUE##% of CPU cycles, placing the processes into ##LEVEL## state.\n\nValues exceeding 100% means the process consumes resources of more than one CPU or core.\n\nThis started at ##START##, -- or ##DURATION## ago.",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17708,
    "dataSourceId" : 13504265,
    "name" : "PercentProcessorTime",
    "description" : "Percentage of elapsed time that all of the threads of this process used the processor to execute instructions.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.PercentProcessorTime",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17709,
    "dataSourceId" : 13504265,
    "name" : "ProcessID",
    "description" : "Used to detect if a process is running.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.ProcessID",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "The process ##INSTANCE## ##DSIDESCRIPTION## on Windows host ##HOST## has stopped and is no longer collecting data, placing the processes into ##LEVEL## state.\n\nThe process has not been detected since ##START##, -- or ##DURATION## ago. .",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17710,
    "dataSourceId" : 13504265,
    "name" : "ThreadCount",
    "description" : "Number of threads currently active in this process.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.ThreadCount",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 17711,
    "dataSourceId" : 13504265,
    "name" : "WorkingSet",
    "description" : "Maximum number of bytes in the working set of this process at any point in time. The working set is the set of memory pages touched recently by the threads in the process.",
    "alertTransitionInterval" : 5,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "namevalue",
    "postProcessorParam" : "##WILDVALUE##.WorkingSet",
    "rawDataFieldName" : "output",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  } ],
  "enableEriDiscovery" : false,
  "eriDiscoveryInterval" : -1,
  "eriDiscoveryConfig" : null
}