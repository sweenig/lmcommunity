{
  "id" : 7148482,
  "description" : "Monitors service state of select Windows Services.",
  "group" : "_WeenigWare ProcessMonitoring",
  "appliesTo" : "isWindows() && Win_Service_Select.includeRegEx && Win_Service_Select.excludeRegEx",
  "technology" : "Only includes services whose short name matches the RegEx pattern in Win_Service_Select.includeRegEx.\nWritten by Stuart Weenig",
  "tags" : "",
  "checksum" : "59e93595ba033aeefe84150a6fad5ecc",
  "lineageId" : "1SqcqlmBRMqB3O5kUkdujg",
  "name" : "Win_Service_Select",
  "displayName" : "Services",
  "version" : 1587137666,
  "auditVersion" : 0,
  "hasMultiInstances" : true,
  "collectInterval" : 180,
  "collectMethod" : "wmi",
  "collectorAttribute" : {
    "name" : "wmi",
    "namespace" : "CIMV2",
    "type" : "query",
    "ip" : "dns",
    "queryClass" : "Win32_Service",
    "queryIndex" : "displayname",
    "queryValue" : "##WILDVALUE##",
    "methodName" : "",
    "targetPath" : "",
    "methodInputs" : ""
  },
  "enableAutoDiscovery" : true,
  "autoDiscoveryConfig" : {
    "persistentInstance" : false,
    "disableInstance" : false,
    "deleteInactiveInstance" : false,
    "instanceAutoGroupMethod" : "ilp",
    "instanceAutoGroupMethodParams" : "auto.WinServiceStartName",
    "scheduleInterval" : 15,
    "method" : {
      "name" : "ad_wmi",
      "wmiClass" : "Win32_Service",
      "property" : "displayname",
      "namespace" : "CIMV2",
      "enableWmiClassILP" : true,
      "ILP" : [ {
        "wmiName" : "StartName",
        "lmName" : "auto.WinServiceStartName"
      }, {
        "wmiName" : "StartMode",
        "lmName" : "auto.WinServiceStartMode"
      } ],
      "enableLinkedClassILP" : false,
      "linkedClasses" : [ ],
      "externalResourceID" : "",
      "externalResourceType" : ""
    },
    "filters" : [ {
      "attribute" : "##WILDALIAS##",
      "operation" : "RegexNotMatch",
      "value" : "##Win_Service_Select.excludeRegEx##",
      "comment" : "Services to exclude, set as property on device."
    }, {
      "attribute" : "auto.WinServiceStartMode",
      "operation" : "NotEqual",
      "value" : "Manual",
      "comment" : ""
    }, {
      "attribute" : "auto.WinServiceStartMode",
      "operation" : "NotEqual",
      "value" : "Disabled",
      "comment" : ""
    }, {
      "attribute" : "##WILDALIAS##",
      "operation" : "RegexMatch",
      "value" : "##Win_Service_Select.includeRegEx##",
      "comment" : "Services to include, set as property on device."
    } ]
  },
  "dataPoints" : [ {
    "id" : 15197,
    "dataSourceId" : 7148482,
    "name" : "RunningStatus",
    "description" : "If service is running, alert if Status is not OK.",
    "alertTransitionInterval" : 3,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "expression",
    "postProcessorParam" : "if(eq(State,1),Status,1)",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "!= 1 1 1",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "The windows service ##INSTANCE## ##DSIDESCRIPTION## on ##HOST## ##GROUP## is running, but not in the OK state.\nIt may be in error, degraded or starting/stoppingstate.\nThis started at ##START## - or ##DURATION## ago.\nContact: ##CUSTCONTACT##",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 15198,
    "dataSourceId" : 7148482,
    "name" : "State",
    "description" : "",
    "alertTransitionInterval" : 3,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "textmatch",
    "postProcessorParam" : "Running",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "State",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 1,
    "alertExpr" : "!= 1 1 1",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "The Windows service ##INSTANCE## ##DSIDESCRIPTION## on ##HOST## ##GROUP## is not running.\nThis started at ##START## - or ##DURATION## ago.\nContact: ##CUSTCONTACT##",
    "enableAnomalyAlertSuppression" : ""
  }, {
    "id" : 15199,
    "dataSourceId" : 7148482,
    "name" : "Status",
    "description" : "",
    "alertTransitionInterval" : 3,
    "alertClearTransitionInterval" : 0,
    "type" : 2,
    "dataType" : 7,
    "maxDigits" : 4,
    "postProcessorMethod" : "textmatch",
    "postProcessorParam" : "OK",
    "rawDataFieldName" : "",
    "maxValue" : "",
    "minValue" : "0",
    "userParam1" : "Status",
    "userParam2" : "",
    "userParam3" : "",
    "alertForNoData" : 3,
    "alertExpr" : "",
    "alertExprNote" : "",
    "alertSubject" : "",
    "alertBody" : "",
    "enableAnomalyAlertSuppression" : ""
  } ],
  "enableEriDiscovery" : false,
  "eriDiscoveryInterval" : -1,
  "eriDiscoveryConfig" : null
}